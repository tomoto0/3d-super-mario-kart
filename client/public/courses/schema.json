{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Mario Kart Course Schema",
  "description": "JSON schema for defining racing courses",
  "type": "object",
  "required": ["meta", "track"],
  "properties": {
    "meta": {
      "type": "object",
      "required": ["id", "name", "theme"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique course identifier"
        },
        "name": {
          "type": "string",
          "description": "Display name of the course"
        },
        "nameJa": {
          "type": "string",
          "description": "Japanese name of the course"
        },
        "theme": {
          "type": "string",
          "enum": ["grassland", "snow", "castle", "beach", "desert", "city", "forest", "volcano", "rainbow"],
          "description": "Visual theme of the course"
        },
        "difficulty": {
          "type": "string",
          "enum": ["easy", "medium", "hard", "expert"],
          "default": "medium"
        },
        "laps": {
          "type": "integer",
          "minimum": 1,
          "maximum": 10,
          "default": 3
        },
        "thumbnail": {
          "type": "string",
          "description": "Path to course thumbnail image"
        },
        "description": {
          "type": "string",
          "description": "Course description"
        }
      }
    },
    "track": {
      "type": "object",
      "required": ["waypoints"],
      "properties": {
        "width": {
          "type": "number",
          "minimum": 5,
          "maximum": 50,
          "default": 16
        },
        "hasWalls": {
          "type": "boolean",
          "default": true
        },
        "waypoints": {
          "type": "array",
          "minItems": 4,
          "items": {
            "type": "object",
            "required": ["x", "z"],
            "properties": {
              "x": { "type": "number" },
              "y": { "type": "number", "default": 0 },
              "z": { "type": "number" },
              "width": { "type": "number", "minimum": 5, "maximum": 50 }
            }
          }
        },
        "finishLine": {
          "type": "object",
          "properties": {
            "waypointIndex": { "type": "integer", "minimum": 0 },
            "direction": { "type": "string", "enum": ["x", "z"] },
            "position": {
              "type": "object",
              "properties": {
                "x": { "type": "number" },
                "y": { "type": "number" },
                "z": { "type": "number" }
              }
            }
          }
        }
      }
    },
    "features": {
      "type": "object",
      "properties": {
        "itemBoxes": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "position": {
                "type": "object",
                "properties": {
                  "x": { "type": "number" },
                  "y": { "type": "number" },
                  "z": { "type": "number" }
                }
              },
              "count": { "type": "integer", "minimum": 1, "default": 1 },
              "spacing": { "type": "number", "minimum": 1, "default": 5 }
            }
          }
        },
        "boostPads": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "position": {
                "type": "object",
                "properties": {
                  "x": { "type": "number" },
                  "y": { "type": "number" },
                  "z": { "type": "number" }
                }
              },
              "rotation": { "type": "number" },
              "width": { "type": "number", "default": 6 },
              "length": { "type": "number", "default": 10 }
            }
          }
        },
        "jumpRamps": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "position": {
                "type": "object",
                "properties": {
                  "x": { "type": "number" },
                  "y": { "type": "number" },
                  "z": { "type": "number" }
                }
              },
              "rotation": { "type": "number" },
              "width": { "type": "number", "default": 12 },
              "height": { "type": "number", "default": 2.5 },
              "boostStrength": { "type": "number", "default": 1.3 }
            }
          }
        }
      }
    },
    "startingGrid": {
      "type": "object",
      "properties": {
        "positions": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "x": { "type": "number" },
              "y": { "type": "number", "default": 0 },
              "z": { "type": "number" },
              "rotation": { "type": "number", "default": 0 }
            }
          }
        }
      }
    },
    "ai": {
      "type": "object",
      "properties": {
        "difficulty": {
          "type": "string",
          "enum": ["easy", "normal", "hard", "expert"],
          "default": "normal"
        },
        "maxSpeedMultiplier": {
          "type": "number",
          "minimum": 0.5,
          "maximum": 2.0,
          "default": 1.0
        },
        "reactionTime": {
          "type": "number",
          "minimum": 0.05,
          "maximum": 1.0,
          "default": 0.15
        },
        "turnAccuracy": {
          "type": "number",
          "minimum": 0.1,
          "maximum": 1.0,
          "default": 0.8
        },
        "itemUseProbability": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "default": 0.7
        },
        "rubberBandStrength": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "default": 0.5
        },
        "mistakeProbability": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "default": 0.1
        }
      }
    },
    "courseSpecific": {
      "type": "object",
      "description": "Course-specific features and settings",
      "additionalProperties": true
    }
  }
}